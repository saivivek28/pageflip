<button [routerLink]="['/home']" class="back-button">‚Üê Back to Home</button>

<div class="favorites-container">
  <div class="favorites-header">
    <h2>My Favorites</h2>
    <p class="favorites-subtitle">Your beloved collection of books</p>
  </div>

  <!-- Search Bar -->
  <!-- <div class="search-section">
    <div class="search-wrapper">
      <input
        type="text"
        placeholder="Search favorites by title or author..."
        [(ngModel)]="searchQuery"
        (input)="onSearchChange()"
        class="search-input"
      />
      <span class="search-icon">üîç</span>
    </div>
  </div> -->

  <!-- Favorites Controls -->
  <div class="favorites-controls">
    <!-- View Toggle -->
    <div class="view-toggle">
      <button 
        [class.active]="viewMode === 'grid'" 
        (click)="setViewMode('grid')" 
        class="view-btn"
        title="Grid View">
        <span class="view-icon">‚äû</span>
      </button>
      <button 
        [class.active]="viewMode === 'list'" 
        (click)="setViewMode('list')" 
        class="view-btn"
        title="List View">
        <span class="view-icon">‚ò∞</span>
      </button>
    </div>

    <!-- Filters -->
    <div class="filter-section">
      <div class="filter-group">
        <label>Genre:</label>
        <div class="filter-chips">
          <button 
            *ngFor="let genre of availableGenres" 
            [class.active]="selectedGenres.includes(genre)"
            (click)="toggleGenreFilter(genre)"
            class="filter-chip">
            {{ genre }}
          </button>
        </div>
      </div>

      <div class="filter-group">
        <label>Rating:</label>
        <div class="filter-chips">
          <button 
            *ngFor="let rating of availableRatings" 
            [class.active]="selectedRatings.includes(rating)"
            (click)="toggleRatingFilter(rating)"
            class="filter-chip">
            {{ rating }}‚òÖ
          </button>
        </div>
      </div>
    </div>

    <!-- Sort -->
    <div class="sort-section">
      <label for="sortSelect">Sort by:</label>
      <select id="sortSelect" [(ngModel)]="sortBy" (change)="onSortChange()" class="sort-select">
        <option value="title">Title A-Z</option>
        <option value="title-desc">Title Z-A</option>
        <option value="author">Author A-Z</option>
        <option value="author-desc">Author Z-A</option>
        <option value="rating">Rating (High to Low)</option>
        <option value="rating-desc">Rating (Low to High)</option>
      </select>
    </div>

    <!-- Clear Filters -->
    <button 
      *ngIf="hasActiveFilters()" 
      (click)="clearAllFilters()" 
      class="clear-filters-btn">
      Clear All Filters
    </button>
  </div>

  <!-- Empty State -->
  <div *ngIf="filteredFavoriteBooks.length === 0" class="empty-state">
    <div class="empty-icon">üíî</div>
    <h3>No favorite books found</h3>
    <p *ngIf="hasActiveFilters()">Try adjusting your filters or search criteria.</p>
    <p *ngIf="!hasActiveFilters() && favoriteBooks.length === 0">You haven't added any books to your favorites yet.</p>
    <p *ngIf="!hasActiveFilters() && favoriteBooks.length > 0">All your favorite books are hidden by current filters.</p>
    <button class="browse-btn" [routerLink]="['/home']">Browse Books</button>
  </div>

  <!-- Book Grid/List -->
  <div class="book-container" [class.list-view]="viewMode === 'list'">
    <div class="book-card" *ngFor="let book of filteredFavoriteBooks; let i = index">
      <div class="book-cover-container">
        <img [src]="book.coverImage" [alt]="book.title" class="book-cover" />
        <div class="book-overlay">
          <button class="favorite-btn favorited" (click)="removeFromFavorites(book)" title="Remove from Favorites">
            <span class="heart-icon">‚ù§Ô∏è</span>
          </button>
        </div>
        <div class="favorite-badge">‚ù§Ô∏è</div>
      </div>
      
      <div class="book-info">
        <h3 class="book-title">{{ book.title }}</h3>
        <p class="book-author">by {{ book.author }}</p>
        <p class="book-genre"><strong>Genre:</strong> {{ book.genre }}</p>
        <div class="book-rating">
          <span class="stars">
            <button 
              type="button"
              *ngFor="let star of [1,2,3,4,5]"
              class="star"
              [class.filled]="star <= (book.rating || 0)"
              [disabled]="submittingRatingFor === book.bookId"
              (click)="rateBook(book, star)">‚òÖ</button>
          </span>
          <span class="rating-text">{{ (book.rating || 0) | number:'1.1-1' }}/5</span>
          <span class="rating-count" *ngIf="book.totalRatings"> ({{ book.totalRatings }})</span>
        </div>
        <p class="book-date" *ngIf="book.dateAdded">
          <strong>Added:</strong> {{ book.dateAdded | date:'mediumDate' }}
        </p>
      </div>
    </div>
  </div>
</div>

